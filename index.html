<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="Samuel Cristobal's homepage" />
        <link rel="shortcut icon" type="image/png" href="./favicon.png" />

        <title>Samuel Cristobal's homepage</title>
        <style>
            :root {
                --text--color: black;
                --bg-color: #dfdfdf;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --text--color: white;
                    --bg-color: #1f1f1f;
                }
            }

            @font-face {
                font-family: 'scumm';
                src: url(./scumm.ttf);
            }

            @font-face {
                font-family: 'scumm-outline';
                src: url(./scumm-outline.otf);
            }

            body {
                margin: 0;
                color: var(--text--color);
            }

            html {
                font-family: 'scumm';
                background-color: var(--bg-color);
            }

            :root {
                --sprite-size: 15rem;
            }

            h1 {
                font-family: 'scumm-outline';
                font-size: 4rem;
                font-weight: normal;
                margin: 0;
            }

            h2 {
                font-size: 1.5rem;
                margin-top: 0;
                font-weight: normal;
            }

            img {
                height: var(--sprite-size);
                width: var(--sprite-size);
                aspect-ratio: 1/1;

                image-rendering: auto;
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
                image-rendering: pixelated;

                /* Safari seems to support, but seems deprecated and does the same thing as the others. */
                justify-self: right;
                padding: 1rem;
            }

            .animated-sprite-sheet {
                --frame-translation: calc(-1 * var(--sprite-size));
                object-fit: cover;
                object-position: 0 var(--frame-translation);
            }

            main {
                display: grid;
                place-items: center;
                margin: 1.5rem;
            }

            .two-column {
                display: flex;
                flex-wrap: wrap-reverse;
            }

            .dialog {
                width: 25rem;
            }

            @media (max-width: 720px) {
                .dialog {
                    min-height: 6rem;
                    bottom: 0;
                }
            }
        </style>
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js"></script>

        <script defer>
            const sentences = [
                'Hi there! my name is Samuel.',
                'I my first computer was a Sinclair Spectrum ZX +2 from 1989.',
                'Soon to be replaced by an all mighty intel 386.',
                'I wrote my first programs in QBasic, and later learned C and Turbo Pascal.',
                'I studied a double degree in Mathematics and Engineering.',
                'Studied algebra and mathematical logic.',
                'Finally I settled as a Software Engineer.',
                'I enjoy programming challenges, like Leet Code or Advent of Code.',
                'Also graphics and physics engines, algorithms and data structures, memory management, language and type theory and everything in between.',
                'My favorite language is Rust and I am most exited about Web Assembly, WebGPU and Web Components.',
            ];

            const timePerCharacter = 50;

            document.addEventListener('alpine:initialized', () => {
                let index = 0;

                function updateText() {
                    const currentSentence = sentences[index];

                    const dialogEvent = new CustomEvent('dialog:update', {
                        detail: currentSentence,
                    });

                    document.dispatchEvent(dialogEvent);

                    const wait = currentSentence.length * timePerCharacter;

                    index = (index + 1) % sentences.length;

                    setTimeout(() => updateText(), wait);
                }

                updateText();
            });
        </script>

        <script defer>
            const totalFrames = 7;
            let currentFrame = 0;

            document.addEventListener('DOMContentLoaded', () => {
                const animatedImg = document.getElementsByClassName('animated-sprite-sheet');

                const a = animatedImg[0];

                setInterval(() => {
                    a.style.setProperty(
                        '--frame-translation',
                        `-${(currentFrame * 15).toFixed(0)}rem`
                    );
                    currentFrame = (currentFrame + 1) % totalFrames;
                }, 500);
            });
        </script>
    </head>

    <body>
        <main>
            <!-- <h1>Samuel Cristobal</h1> -->
            <!-- <h2>Software Engineer</h2> -->
            <div class="two-column">
                <picture>
                    <!-- <source srcset="./portrait.apng" type="image/apng" /> -->
                    <img
                        class="animated-sprite-sheet"
                        src="./sprite_sheet.png"
                        type="image/png"
                        alt="Samuel Cristobal in pixel art style" />
                </picture>
                <p
                    class="dialog"
                    x-data="{text: undefined}"
                    @dialog:update.document="text=$event.detail"
                    x-text="text"></p>
            </div>
        </main>
    </body>
</html>
